<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>多语言复习系统</title>
    <style>
        /* 样式优化 */
        :root {
            --en-color: #4CAF50;
            --fr-color: #2196F3;
            --de-color: #9C27B0;
            --ar-color: #FF9800;
        }
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .language-section {
            padding: 20px;
            border-radius: 10px;
            border: 2px solid var(--primary-color);
        }
        .dynamic-inputs { margin: 10px 0; }
        .gender-buttons { display: flex; gap: 5px; }
        .gender-buttons button { padding: 5px 10px; }
        .conjugation-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 5px;
        }
    </style>
</head>
<body>
    <!-- 输入区 -->
    <div class="section">
        <h2>添加新词条</h2>
        <select id="language" onchange="updateInputFields()">
            <option value="en">英语</option>
            <option value="fr">法语</option>
            <option value="de">德语</option>
            <option value="ar">阿拉伯语</option>
        </select>

        <!-- 通用字段 -->
        <input type="text" id="word" placeholder="单词/短语">
        <input type="text" id="translation" placeholder="中文翻译">

        <!-- 动态输入区 -->
        <div id="dynamic-inputs"></div>
        <button onclick="addWord()">添加词条</button>
    </div>

    <!-- 数据展示区 -->
    <div class="section">
        <h2>词库管理</h2>
        <div id="word-list"></div>
    </div>

<script>
// 数据存储结构
let words = {
    en: JSON.parse(localStorage.getItem('words_en')) || [],
    fr: JSON.parse(localStorage.getItem('words_fr')) || [],
    de: JSON.parse(localStorage.getItem('words_de')) || [],
    ar: JSON.parse(localStorage.getItem('words_ar')) || []
};

// 根据语言更新输入界面
function updateInputFields() {
    const lang = document.getElementById('language').value;
    const container = document.getElementById('dynamic-inputs');
    
    container.innerHTML = ''; // 清空原有内容

    switch(lang) {
        case 'en':
            container.innerHTML = `
                <input type="text" id="note" placeholder="备注（可选）">
            `;
            break;
            
        case 'fr':
        case 'de':
            container.innerHTML = `
                <select id="word-type" onchange="updateConjugationFields()">
                    <option value="noun">名词</option>
                    <option value="verb">动词</option>
                    <option value="other">其他</option>
                </select>
                <div id="gender-input"></div>
                <div id="conjugation-input"></div>
            `;
            updateConjugationFields();
            break;
            
        case 'ar':
            container.innerHTML = `
                <select id="word-type">
                    <option value="noun">名词</option>
                    <option value="verb">动词</option>
                </select>
                <input type="text" id="root-letters" placeholder="词根字母">
            `;
            break;
    }
}

// 更新变位/性别输入
function updateConjugationFields() {
    const lang = document.getElementById('language').value;
    const wordType = document.getElementById('word-type').value;
    const container = document.getElementById('conjugation-input');
    const genderContainer = document.getElementById('gender-input');
    
    genderContainer.innerHTML = '';
    container.innerHTML = '';

    if (wordType === 'noun') {
        // 性别选择
        const genders = lang === 'fr' ? ['阴', '阳'] : ['阴', '阳', '中'];
        genderContainer.innerHTML = `
            <div class="gender-buttons">
                ${genders.map(g => `
                    <button type="button" onclick="selectGender('${g}')">${g}</button>
                `).join('')}
            </div>
            <input type="text" id="plural" placeholder="复数形式">
        `;
    } else if (wordType === 'verb') {
        // 动词变位模板
        const conjugations = {
            fr: ['现在时', '未完成过去时', '复合过去时', '简单将来时', '条件式现在时', '虚拟式现在时'],
            de: ['现在时', '过去时', '完成时']
        }[lang];
        
        container.innerHTML = `
            <div class="conjugation-grid">
                ${conjugations.map(c => `
                    <div>
                        <label>${c}</label>
                        <input type="text" data-tense="${c}">
                    </div>
                `).join('')}
            </div>
        `;
    }
}

// 添加词条
function addWord() {
    const lang = document.getElementById('language').value;
    const baseData = {
        word: document.getElementById('word').value,
        translation: document.getElementById('translation').value
    };

    let specificData = {};
    switch(lang) {
        case 'en':
            specificData.note = document.getElementById('note')?.value;
            break;
            
        case 'fr':
        case 'de':
            const wordType = document.getElementById('word-type').value;
            specificData.type = wordType;
            
            if (wordType === 'noun') {
                specificData = {
                    gender: selectedGender,
                    plural: document.getElementById('plural').value
                };
            } else if (wordType === 'verb') {
                specificData.conjugations = {};
                document.querySelectorAll('#conjugation-input input').forEach(input => {
                    specificData.conjugations[input.dataset.tense] = input.value;
                });
            }
            break;
            
        case 'ar':
            specificData = {
                type: document.getElementById('word-type').value,
                rootLetters: document.getElementById('root-letters').value
            };
            break;
    }

    words[lang].push({...baseData, ...specificData});
    localStorage.setItem(`words_${lang}`, JSON.stringify(words[lang]));
    updateWordList();
}

// 更新词库显示
function updateWordList() {
    const lang = document.getElementById('language').value;
    const list = document.getElementById('word-list');
    
    list.innerHTML = words[lang].map(word => `
        <div class="word-item">
            <h3>${word.word} (${lang.toUpperCase()})</h3>
            <p>翻译：${word.translation}</p>
            ${word.note ? `<p>备注：${word.note}</p>` : ''}
            ${word.gender ? `<p>性别：${word.gender}</p>` : ''}
            ${word.plural ? `<p>复数：${word.plural}</p>` : ''}
            ${word.conjugations ? `
                <div class="conjugations">
                    ${Object.entries(word.conjugations).map(([tense, form]) => `
                        <div>${tense}: ${form}</div>
                    `).join('')}
                </div>
            ` : ''}
        </div>
    `).join('');
}

// 初始化
updateInputFields();
updateWordList();
</script>
</body>
</html>
