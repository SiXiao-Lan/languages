<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>语言复习助手</title>
    <style>
        :root {
            --primary-color: #4CAF50;
            --secondary-color: #2196F3;
        }
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
        }
        .section {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 10px;
        }
        input, select, button {
            margin: 5px;
            padding: 8px;
            width: 200px;
        }
        .conjugation-inputs {
            margin: 10px 0;
        }
        #word-list {
            max-height: 300px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <!-- 输入区 -->
    <div class="section">
        <h2>添加新词条</h2>
        <select id="language">
            <option value="en">英语</option>
            <option value="fr">法语</option>
            <option value="es">西班牙语</option>
        </select>
        <input type="text" id="word" placeholder="单词">
        <input type="text" id="translation" placeholder="翻译">
        <select id="word-type">
            <option value="noun">名词</option>
            <option value="verb">动词</option>
            <option value="adj">形容词</option>
        </select>
        <div class="conjugation-inputs" id="conjugation-box">
            <input type="text" placeholder="变位形式 (如: eat/ate/eaten)">
        </div>
        <button onclick="addWord()">添加词条</button>
    </div>

    <!-- 数据列表 -->
    <div class="section">
        <h2>已存词条 (共<span id="count">0</span>条)</h2>
        <div id="word-list"></div>
    </div>

    <!-- 考核区 -->
    <div class="section">
        <h2>考核模式</h2>
        <button onclick="startQuiz()">开始考核 (10题)</button>
        <div id="quiz-area"></div>
        <div id="score" style="margin-top: 20px;"></div>
    </div>

    <script>
        // 本地存储初始化
        let words = JSON.parse(localStorage.getItem('words')) || [];

        // 动态添加变位输入框
        document.getElementById('word-type').addEventListener('change', function() {
            const conjugationBox = document.getElementById('conjugation-box');
            conjugationBox.innerHTML = this.value === 'verb' ? 
                '<input type="text" placeholder="现在时">' +
                '<input type="text" placeholder="过去时">' +
                '<input type="text" placeholder="过去分词">' :
                '<input type="text" placeholder="其他形式">';
        });

        // 添加词条
        function addWord() {
            const word = {
                language: document.getElementById('language').value,
                word: document.getElementById('word').value,
                translation: document.getElementById('translation').value,
                type: document.getElementById('word-type').value,
                conjugations: Array.from(document.querySelectorAll('#conjugation-box input')).map(i => i.value)
            };
            
            words.push(word);
            localStorage.setItem('words', JSON.stringify(words));
            updateWordList();
        }

        // 更新词条列表
        function updateWordList() {
            const list = document.getElementById('word-list');
            list.innerHTML = words.map((word, index) => `
                <div style="margin: 10px 0; padding: 10px; background: white;">
                    <b>${word.word}</b> (${word.type})<br>
                    翻译: ${word.translation}<br>
                    ${word.conjugations.join(' / ')}
                </div>
            `).join('');
            document.getElementById('count').textContent = words.length;
        }

        // 考核逻辑
        function startQuiz() {
            if (words.length === 0) return alert('请先添加词条！');
            
            const quizWords = getRandomWords(10);
            let current = 0, score = 0;

            function showQuestion() {
                const word = quizWords[current];
                const quizArea = document.getElementById('quiz-area');
                
                quizArea.innerHTML = `
                    <div style="margin: 20px 0;">
                        <h3>第 ${current + 1} 题</h3>
                        <p>${getQuestionText(word)}</p>
                        <input type="text" id="answer">
                        <button onclick="checkAnswer()">提交</button>
                    </div>
                `;
            }

            window.checkAnswer = () => {
                const userAnswer = document.getElementById('answer').value.trim();
                const correctAnswers = getCorrectAnswers(quizWords[current]);
                
                if (correctAnswers.includes(userAnswer.toLowerCase())) {
                    score++;
                    alert('正确！✅');
                } else {
                    alert(`错误！❌ 正确答案是: ${correctAnswers.join(' 或 ')}`);
                }

                current++;
                if (current < quizWords.length) {
                    showQuestion();
                } else {
                    showScore();
                }
            }

            function getQuestionText(word) {
                // 随机出题类型
                const types = [
                    `翻译 "${word.translation}" 的${word.language === 'en' ? '英语' : '外语'}单词是？`,
                    `"${word.word}" 的过去分词形式是？`,
                    `"${word.translation}" 对应的${word.type}是什么？`
                ];
                return types[Math.floor(Math.random() * types.length)];
            }

            function showScore() {
                document.getElementById('score').innerHTML = `
                    <h3>得分: ${score}/${quizWords.length}</h3>
                    <button onclick="startQuiz()">重新测试</button>
                `;
            }

            showQuestion();
        }

        // 工具函数
        function getRandomWords(n) {
            return [...words].sort(() => Math.random() - 0.5).slice(0, n);
        }

        function getCorrectAnswers(word) {
            // 根据题目类型返回可能正确答案
            return [
                word.word.toLowerCase(),
                word.translation.toLowerCase(),
                ...word.conjugations.map(c => c.toLowerCase())
            ];
        }

        // 初始化
        updateWordList();
    </script>
</body>
</html>
